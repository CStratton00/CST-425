---
title: "Texas Instruments Stock Performance"
author: "Andrew Esch, Evan Lee, Collin Stratton"
date: "1/16/2022"
output: word_document
---
## Introduction
### Problem Statement

### Algorithm of the Solution

## Data Setup and exploration
```{r Import Data}
txn <- read.csv(file='PerformancePredictions/TXN.csv', header=TRUE, sep=',')
txn.df <- data.frame(txn)
head(txn.df)

# Check for missing values
sum(is.na(txn.df))

# Find data correlation
cor(txn.df[2:7])
```
## Training and Testing Sets Preparation
```{r Split Sets}
library(caTools)
set.seed(123)  # to reproduce the sample

# Split training and testing based on "High" variable
sample <- sample.split(txn.df$High, SplitRatio = 0.7) # Split using 70/30 ratio (backed up with research)

# Create training/testing csv files
txn.df.train <- subset(txn.df, sample==TRUE)
txn.df.test <- subset(txn.df, sample==FALSE)

# Display training dataframe
head(txn.df.train)
tail(txn.df.train)
```

## Test Set Predictions (Build the model)
```{r model}

highModel <- lm(High ~., data = txn.df.train[2:7])
summary(highModel)
```

### Improve the model using only significant variables

```{r improved_model}
# Choose only variables with p-value < 2.2e-16

highModel.significantVars <- lm(High ~ Open + Close + Volume, data = txn.df.train)
highModel.significantVars

summary(highModel.significantVars)
```

### Regression output intepretation

For example, for every unit of **volatile.acidity** the quality decreases by 1.97 units, or for every increase in a unit of **sulphates** the quality increases by 0.746 units
```{r interpretation}
# The variables used in the model
names(highModel.significantVars)

# The number of fitted values in the model
length(highModel.significantVars$fitted.values)

```

## Investment Worthiness Predication Results

```{r}
library(pracma)
xtime <- linspace(1,1259, n=1259)
highy <- txn.df[,"High"]

plot(xtime,highy)
abline(lm(highy~xtime))
```
```{r Fitted Values and Residuals}

#Calculate the predicted values using the highmodel fitted values
predicted.train <- highModel.significantVars$fitted.values

#print out first 6 figures of predicted training model
head(predicted.train)

#make predicted training model a data frame
predicted.train.df <- data.frame(predicted.train)

# Calculate residual values
predicted.train.df.residuals <- highModel.significantVars$residuals
head(predicted.train.df.residuals)
```



## Analysis of the Findings


## References
